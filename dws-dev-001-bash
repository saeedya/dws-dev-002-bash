#!/bin/bash
#how to use this scrip: ./dws-dev-001-bash try -i "interval_number" -n "iteration_number" flask app test

# This function is for "flask app test" execution
function run_cmd {
        $("$6" "$7" "$8")
}
# Calling "run_cmd" function
run_cmd

# This if statement will check if "run_cmd" output exit 0 or 1
# If true exit 0
# otherwise will repeat for number of times wih an interval

if [[ $? -eq 0 ]]; then
        exit 0
else
        for i in $(seq $5); do
                sleep $3
                run_cmd
                if [[ $? -eq 0 ]]; then
                        exit 0
                fi
        done
fi
# After above condition if there is no success then print "We have an error!!!!" then exit 1
echo "We have an error!!!!"
exit 1
